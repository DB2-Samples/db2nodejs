<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Project X</title>
    <link rel="stylesheet" type="text/css" href="build/bootstrap/css/bootstrap.min.css">
    <script src="build/jquery.min.js"></script>
    <script type="text/javascript" src="build/login.js"></script>
    <style>
        body{
            width:100%;
            height:100%;
            overflow: hidden;
        }
        .blur {
            -webkit-filter: blur(5px); /* Chrome, Opera */
            -moz-filter: blur(5px);
            -ms-filter: blur(5px);
            filter: blur(5px);
            margin: -15px;
            width: 110%;
            height:110%;
            -webkit-background-size:100% 100%;
            background-size:100% 100%;
            background-repeat: no-repeat;
            background-image: url('source/svl.jpg');
            position: absolute;
            left:0;top:0;
        }
        .input{
            max-height:420px;
            width:360px;
            border-radius: 10px;
            background-color:rgba(100,100,100,0.4);
            box-shadow: 0px 5px 10px white;
            margin:-260px auto;
            position: relative;
            height:100%;
            top:50%;
            color: white;
            padding: 140px 20px 40px;
        }
        .input .logo{
            position: relative;
            height:180px;
            width:180px;
            margin:auto auto;
            margin-top: -80px;
        }
        .logo img{
            width:100%;
            height:100%;
        }
        .login{
            width:100%;
            margin-top: 20px;
            background-color: #325c80;
            border:none;
        }
        .main{
            position: relative;
            z-index: 2;
            left:0;
            width:100%;
            height:100%;
        }
        .foot
        er{
            width:100%;
            height:23%;
            position: absolute;
            bottom:0;
            background-color: #325c80;
            opacity: 0.9;
        }
        .header{
          border-bottom:none;
          height:50px;
          positive:relative;
        }
        .header .switch{
          left:70px;
          margin-top: -100px
        }
        .header .switch{
          font-size: 16px;
          height:45px;
          left:60px;
          position: absolute;
        }
        .header .switch #switch_qlogin {
          margin-right: 85px;
        }
        .header .switch .switch_btn_focus {
          color:white;
          display: inline-block;
          height: 45px;
          line-height: 45px;
          outline: medium none;
        }
        a {
          text-decoration: none;
        }
        .header .switch .switch_btn {
          color: white;
          display: inline-block;
          height: 45px;
          line-height: 45px;
          outline: medium none;
        }
        a {
          text-decoration: none;
        }
        element.style {
          left: 0;
          position: absolute;
          width: 70px;
        }
        #switch_bottom {
          border-bottom: 2px solid white;
          bottom: -1px;
          position: absolute;
        }
        .web_login{
          margin-top: 200px;
          padding-bottom: 20px;
          positive:relative;
          width:400px
        }
        .web_login
        .web_form{
          margin:0 auto;
          width:300px;
        }
        ul{
          padding:0;
        }
        .reg_form li{
          height:55px;
        }
        ul li{
          list-style-type:none;
        }
        .web_login .inputOuter2 {
          float: left;
          margin-top: 6px;
          width: auto;
        }
        .web_login .inputstyle2 {
          border-radius: 2px;
          width: auto;
        }
        a.zcxy {
          color: white;
          line-height: 58px;
          margin-left: 15px;
          text-decoration: underline;
        }
    </style>


</head>
<body>
    <div class="blur"></div>
    <div class="main">
        <div class="input">

          <div class="header">
            <div id="switch" class="switch">
              <a id="switch_qlogin" class="switch_btn_focus" href="javascript:void(0)" >Login</a>
              <a id="switch_login" class="switch_btn" href="javascript:void(0)" >Register</a>
              <div id="switch_bottom" class="switch_bottom" style="position: absolute; width: 80px; left: 0px;"></div>
            </div>
          </div>
          <div id="web_qr_login" class="web_qr_login" style="display: block; height:auto;">
          <form>
            <input name="did" value="0" type="hidden">
            <input name="to" value="log" type="hidden">
            <div class="form-group" >
                <input type="text" class="form-control" name="username" id="username" aria-describedby="emailHelp" placeholder="User name." style="width:230px;margin-left:45px">
                <br/>
                <input type="password" class="form-control" name="password" id="password"  placeholder="Password." style="width:230px;margin-left:45px">
                <button class="btn login btn-primary" id="btn" type="button" style="width:230px;margin-left:45px">
                    Sign in
                </button>
            </div>
          </form>
        </div>
        <div id="qlogin" class="qlogin" style="display:none">
          <div class="web_login" >
            <form id="regUser" name="form2" action="#" method="post" style="margin-top:-260px;margin-left:50px">

              <input name="to" value="reg" type="hidden">
              <input name="did" value="0" type="hidden">
              <ul id="reg-ul" class="reg_form">
                <li>
                  <div class="inputOuter2">
                    <input id="user" class="form-control" name="user" maxlength="16" type="text" placeholder="User name.">
                  </div>
                </li>
                <li>
                  <div class="inputOuter2">
                    <input id="passwd" class="form-control" name="passwd" maxlength="16" type="password" placeholder="Password.">
                  </div>
                </li>
                <li>
                  <div class="inputOuter2">
                    <input id="passwd2" class="form-control" name="" maxlength="16" type="password" placeholder="Confirm pwd.">
                  </div>
                </li>

                <li>
                  <div class="inputArea">
                    <input id="reg" class="btn login btn-primary" style="margin-top:10px;width:220px" value="Agree and register" type="button">
                    <br/>
                    <a class="zcxy" href="#" target="_blank">Registration Agreement</a>
                  </div>
                </li>
                <div class="cl"></div>
              </ul>
            </form>

          </div>
        </div>
      </div>

    </div>



    <div class="footer"></div>


</body>
<script>
    var stable = 4160 / 3120;
    var blurContainer = document.querySelector('div.blur');
    var resize = function(){
        var curWindow = window.innerWidth/window.innerHeight;
        var width,height;
        var marginLeft = -15, marginTop = -15;
        if(curWindow>stable){
            width = window.innerWidth + 30;
            height = parseInt(width/stable) + 1;
            marginTop = (window.innerHeight - height)/2;
        }else{
            height = window.innerHeight + 30;
            width = parseInt(height*stable) + 1;
            marginLeft = (window.innerWidth - width)/2;
        }
        blurContainer.style.width = width + 'px';
        blurContainer.style.height = height + 'px';
        blurContainer.style.marginTop = marginTop + 'px';
        blurContainer.style.marginLeft = marginLeft + 'px';
    }
    var load = function(){
        resize();
    }
    var init = function(){
        window.onresize = resize;
        window.onload = load;
        document.getElementById('username').onkeydown = function(e){
                  if(e.which===13){
                      login();

            }
        }
    }
    init();
    function login(){
        var user = document.getElementById("username").value;
        var pwd = document.getElementById("password").value;
        if((user&&/^[a-zA-Z]*$/g.test(user))){
            window.location.replace('/'+user);
        }
        else if(user){
            alert('Please input the correct username or password')
        }
        return false;
    }

</script>
<script type="text/javascript">
   $("#btn").click(function(){
       var params={
         username:$("#username").val(),
         password:$("#password").val()
       };
       $.ajax({
                data: params,
                url: '/login',
                type:'get',
                dataType: 'json',
                success: function(data){

                    console.log(data);
                    if(data.result=="success"&&data.user){
                      window.location.href = '/'+data.user;
                    }
                    else{
                      alert('login failed')
                    }

                  },

                error: function(jqXHR, textStatus, errorThrown){
                    alert('login failed');
                }
          });
      });
</script>

</html>
